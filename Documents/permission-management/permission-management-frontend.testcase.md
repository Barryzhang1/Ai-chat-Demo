# 前端权限控制测试用例

## 测试目标
验证前端权限控制系统是否正确实现角色权限管理功能。

## 测试环境
- **项目**: ChatUI
- **测试范围**: 角色选择页面、商家后台、权限管理、数据报表
- **角色类型**: BOSS（老板）、STAFF（员工）、USER（普通用户）

---

## 1. 角色选择页面权限测试

### 测试用例 1.1：USER 角色访问限制

**测试编号**: TC-ROLE-001  
**测试目标**: USER 角色无法访问商家后台  
**前置条件**: 使用 USER 角色登录系统  
**测试步骤**:
1. 登录系统并进入角色选择页面
2. 观察商家后台入口状态
3. 点击商家后台入口

**预期结果**:
- 商家后台卡片显示为禁用状态（透明度 0.5）
- 显示提示文字"仅限老板/员工"
- 点击后显示 Toast 提示："权限不足，只有老板和员工可以访问商家后台"
- 不会跳转到商家后台页面

---

### 测试用例 1.2：STAFF 角色访问权限

**测试编号**: TC-ROLE-002  
**测试目标**: STAFF 角色可以访问商家后台  
**前置条件**: 使用 STAFF 角色登录系统  
**测试步骤**:
1. 登录系统并进入角色选择页面
2. 观察商家后台入口状态
3. 点击商家后台入口

**预期结果**:
- 商家后台卡片正常显示（透明度 1）
- 不显示权限限制提示
- 点击后成功跳转到商家后台页面

---

### 测试用例 1.3：BOSS 角色访问权限

**测试编号**: TC-ROLE-003  
**测试目标**: BOSS 角色可以访问商家后台  
**前置条件**: 使用 BOSS 角色登录系统  
**测试步骤**:
1. 登录系统并进入角色选择页面
2. 观察商家后台入口状态
3. 点击商家后台入口

**预期结果**:
- 商家后台卡片正常显示（透明度 1）
- 不显示权限限制提示
- 点击后成功跳转到商家后台页面

---

### 测试用例 1.4：角色信息显示

**测试编号**: TC-ROLE-004  
**测试目标**: 角色选择页面正确显示当前用户角色  
**前置条件**: 使用任意角色登录系统  
**测试步骤**:
1. 登录系统并进入角色选择页面
2. 观察页面中的角色信息显示

**预期结果**:
- 在欢迎信息下方显示"当前角色：XXX"
- 角色名称正确显示（老板/员工/用户）

---

## 2. 商家后台菜单权限测试

### 测试用例 2.1：BOSS 角色菜单显示

**测试编号**: TC-MERCHANT-001  
**测试目标**: BOSS 角色可以看到所有菜单项  
**前置条件**: 使用 BOSS 角色登录并进入商家后台  
**测试步骤**:
1. 进入商家后台页面
2. 查看所有显示的菜单项

**预期结果**:
- 显示基础菜单：订单列表、菜品列表、库存管理、进货管理、座位管理、游戏排行、类别管理
- 显示 BOSS 专属菜单：数据报表、权限管理
- 共计 9 个菜单项

---

### 测试用例 2.2：STAFF 角色菜单显示

**测试编号**: TC-MERCHANT-002  
**测试目标**: STAFF 角色只能看到基础菜单  
**前置条件**: 使用 STAFF 角色登录并进入商家后台  
**测试步骤**:
1. 进入商家后台页面
2. 查看所有显示的菜单项

**预期结果**:
- 显示基础菜单：订单列表、菜品列表、库存管理、进货管理、座位管理、游戏排行、类别管理
- 不显示：数据报表、权限管理
- 共计 7 个菜单项

---

### 测试用例 2.3：USER 角色访问商家后台

**测试编号**: TC-MERCHANT-003  
**测试目标**: USER 角色无法访问商家后台  
**前置条件**: 使用 USER 角色登录系统  
**测试步骤**:
1. 尝试直接访问 `/merchant` 路径
2. 观察页面跳转和提示

**预期结果**:
- 显示 Toast 提示："权限不足，只有老板和员工可以访问"
- 自动重定向到角色选择页面 `/role-select`

---

## 3. 权限管理页面访问测试

### 测试用例 3.1：BOSS 角色访问权限管理

**测试编号**: TC-PERMISSION-001  
**测试目标**: BOSS 角色可以访问权限管理页面  
**前置条件**: 使用 BOSS 角色登录系统  
**测试步骤**:
1. 进入商家后台页面
2. 点击"权限管理"菜单
3. 观察页面跳转

**预期结果**:
- 成功进入权限管理页面
- 可以查看用户列表
- 可以修改用户角色

---

### 测试用例 3.2：STAFF 角色访问权限管理

**测试编号**: TC-PERMISSION-002  
**测试目标**: STAFF 角色无法访问权限管理页面  
**前置条件**: 使用 STAFF 角色登录系统  
**测试步骤**:
1. 尝试直接访问 `/merchant/permissions` 路径
2. 观察页面跳转和提示

**预期结果**:
- 显示 Toast 提示："权限不足，只有老板可以访问此功能"
- 自动重定向到商家后台首页 `/merchant`

---

### 测试用例 3.3：USER 角色访问权限管理

**测试编号**: TC-PERMISSION-003  
**测试目标**: USER 角色无法访问权限管理页面  
**前置条件**: 使用 USER 角色登录系统  
**测试步骤**:
1. 尝试直接访问 `/merchant/permissions` 路径
2. 观察页面跳转和提示

**预期结果**:
- 显示 Toast 提示："权限不足，只有老板和员工可以访问"
- 自动重定向到角色选择页面 `/role-select`

---

## 4. 数据报表页面访问测试

### 测试用例 4.1：BOSS 角色访问数据报表

**测试编号**: TC-REPORTS-001  
**测试目标**: BOSS 角色可以访问数据报表页面  
**前置条件**: 使用 BOSS 角色登录系统  
**测试步骤**:
1. 进入商家后台页面
2. 点击"数据报表"菜单
3. 观察页面跳转

**预期结果**:
- 成功进入数据报表页面
- 可以查看各类数据统计

---

### 测试用例 4.2：STAFF 角色访问数据报表

**测试编号**: TC-REPORTS-002  
**测试目标**: STAFF 角色无法访问数据报表页面  
**前置条件**: 使用 STAFF 角色登录系统  
**测试步骤**:
1. 尝试直接访问 `/merchant/reports` 路径
2. 观察页面跳转和提示

**预期结果**:
- 显示 Toast 提示："权限不足，只有老板可以访问此功能"
- 自动重定向到商家后台首页 `/merchant`

---

### 测试用例 4.3：USER 角色访问数据报表

**测试编号**: TC-REPORTS-003  
**测试目标**: USER 角色无法访问数据报表页面  
**前置条件**: 使用 USER 角色登录系统  
**测试步骤**:
1. 尝试直接访问 `/merchant/reports` 路径
2. 观察页面跳转和提示

**预期结果**:
- 显示 Toast 提示："权限不足，只有老板和员工可以访问"
- 自动重定向到角色选择页面 `/role-select`

---

## 5. 其他商家后台页面访问测试

### 测试用例 5.1：STAFF 访问基础功能

**测试编号**: TC-BASIC-001  
**测试目标**: STAFF 角色可以访问基础商家功能  
**前置条件**: 使用 STAFF 角色登录系统  
**测试步骤**:
1. 依次访问以下页面：
   - 订单列表 `/merchant/orders`
   - 菜品列表 `/merchant/inventory`
   - 库存管理 `/merchant/inventory/list`
   - 进货管理 `/merchant/inventory/purchase-order`
   - 座位管理 `/merchant/seats`
   - 游戏排行 `/merchant/rankings`
   - 类别管理 `/merchant/categories`

**预期结果**:
- 所有页面都可以正常访问
- 不会出现权限拒绝提示

---

### 测试用例 5.2：USER 访问基础功能

**测试编号**: TC-BASIC-002  
**测试目标**: USER 角色无法访问任何商家后台功能  
**前置条件**: 使用 USER 角色登录系统  
**测试步骤**:
1. 依次尝试访问以下页面：
   - 订单列表 `/merchant/orders`
   - 菜品列表 `/merchant/inventory`
   - 库存管理 `/merchant/inventory/list`

**预期结果**:
- 所有页面都无法访问
- 显示 Toast 提示："权限不足，只有老板和员工可以访问"
- 自动重定向到角色选择页面

---

## 6. 权限工具函数测试

### 测试用例 6.1：getUserRole() 函数

**测试编号**: TC-UTIL-001  
**测试目标**: 正确解析 JWT Token 中的角色信息  
**前置条件**: 用户已登录  
**测试方法**: 单元测试或浏览器控制台测试  
**测试步骤**:
```javascript
import { getUserRole } from './utils/permission';
console.log(getUserRole()); // 应输出 'BOSS' | 'STAFF' | 'USER'
```

**预期结果**:
- 返回正确的用户角色字符串
- 未登录时返回 `null`

---

### 测试用例 6.2：canAccessMerchant() 函数

**测试编号**: TC-UTIL-002  
**测试目标**: 正确判断用户是否可以访问商家后台  
**测试步骤**:
```javascript
import { canAccessMerchant } from './utils/permission';
console.log(canAccessMerchant()); // BOSS/STAFF 返回 true, USER 返回 false
```

**预期结果**:
- BOSS 和 STAFF 角色返回 `true`
- USER 角色返回 `false`
- 未登录返回 `false`

---

### 测试用例 6.3：isBoss() 函数

**测试编号**: TC-UTIL-003  
**测试目标**: 正确判断用户是否是 BOSS  
**测试步骤**:
```javascript
import { isBoss } from './utils/permission';
console.log(isBoss()); // BOSS 返回 true, 其他返回 false
```

**预期结果**:
- BOSS 角色返回 `true`
- STAFF 和 USER 角色返回 `false`
- 未登录返回 `false`

---

## 测试总结

### 测试覆盖率
- ✅ 角色选择页面权限：4个测试用例
- ✅ 商家后台菜单权限：3个测试用例
- ✅ 权限管理页面访问：3个测试用例
- ✅ 数据报表页面访问：3个测试用例
- ✅ 其他商家功能访问：2个测试用例
- ✅ 权限工具函数：3个测试用例

**总计：18个测试用例**

### 权限控制矩阵

| 功能 | USER | STAFF | BOSS |
|-----|------|-------|------|
| 用户页面 | ✅ | ✅ | ✅ |
| 商家后台入口 | ❌ | ✅ | ✅ |
| 订单管理 | ❌ | ✅ | ✅ |
| 菜品管理 | ❌ | ✅ | ✅ |
| 库存管理 | ❌ | ✅ | ✅ |
| 进货管理 | ❌ | ✅ | ✅ |
| 座位管理 | ❌ | ✅ | ✅ |
| 游戏排行 | ❌ | ✅ | ✅ |
| 类别管理 | ❌ | ✅ | ✅ |
| 数据报表 | ❌ | ❌ | ✅ |
| 权限管理 | ❌ | ❌ | ✅ |

---

**文档创建日期**: 2026-02-01  
**测试负责人**: GitHub Copilot  
**状态**: ✅ 待执行测试
