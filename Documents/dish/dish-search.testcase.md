# 菜品搜索功能测试用例

## 测试概述

**功能名称**：菜品搜索功能  
**测试范围**：后端API搜索、前端搜索界面  
**涉及模块**：ChatBackEnd/dish、ChatUI/Inventory、ChatUI/MenuBrowse  

---

## 后端API测试用例

### 测试用例 1：按关键词搜索菜品

**测试目标**：验证通过关键词搜索菜品名称  
**请求方式**：GET  
**请求URL**：`/api/dish?keyword=宫保`  

**前置条件**：
- 数据库中存在菜品"宫保鸡丁"
- 数据库中存在其他包含"宫保"的菜品

**测试步骤**：
1. 发送GET请求到 `/api/dish?keyword=宫保`
2. 验证响应状态码为200
3. 验证返回的菜品列表中所有菜品名称包含"宫保"字符

**预期结果**：
```json
[
  {
    "_id": "...",
    "name": "宫保鸡丁",
    "price": 38,
    "categoryId": "...",
    ...
  }
]
```

---

### 测试用例 2：按分类ID搜索菜品

**测试目标**：验证按分类ID筛选菜品  
**请求方式**：GET  
**请求URL**：`/api/dish?categoryId=507f191e810c19729de860ea`  

**前置条件**：
- 数据库中存在该分类ID的菜品

**测试步骤**：
1. 发送GET请求到 `/api/dish?categoryId=507f191e810c19729de860ea`
2. 验证响应状态码为200
3. 验证返回的所有菜品的categoryId都等于指定的分类ID

**预期结果**：
- 返回该分类下的所有菜品
- 所有菜品的`categoryId`字段值相同

---

### 测试用例 3：按标签搜索菜品

**测试目标**：验证按标签筛选菜品  
**请求方式**：GET  
**请求URL**：`/api/dish?tag=招牌菜`  

**前置条件**：
- 数据库中存在带有"招牌菜"标签的菜品

**测试步骤**：
1. 发送GET请求到 `/api/dish?tag=招牌菜`
2. 验证响应状态码为200
3. 验证返回的所有菜品的tags数组中包含"招牌菜"

**预期结果**：
- 返回所有标签中包含"招牌菜"的菜品

---

### 测试用例 4：组合搜索（关键词+分类）

**测试目标**：验证多条件组合搜索  
**请求方式**：GET  
**请求URL**：`/api/dish?keyword=鸡&categoryId=507f191e810c19729de860ea`  

**前置条件**：
- 数据库中存在符合条件的菜品

**测试步骤**：
1. 发送GET请求到 `/api/dish?keyword=鸡&categoryId=507f191e810c19729de860ea`
2. 验证响应状态码为200
3. 验证返回的菜品同时满足：
   - 名称包含"鸡"
   - categoryId等于指定值

**预期结果**：
- 返回同时满足两个条件的菜品列表

---

### 测试用例 5：空搜索结果

**测试目标**：验证搜索无结果时的响应  
**请求方式**：GET  
**请求URL**：`/api/dish?keyword=不存在的菜品名称xyz`  

**测试步骤**：
1. 发送GET请求
2. 验证响应状态码为200
3. 验证返回空数组

**预期结果**：
```json
[]
```

---

### 测试用例 6：不区分大小写搜索

**测试目标**：验证搜索不区分大小写  
**请求方式**：GET  
**请求URL**：`/api/dish?keyword=GONGBAO`  

**前置条件**：
- 数据库中存在"宫保鸡丁"菜品

**测试步骤**：
1. 发送GET请求到 `/api/dish?keyword=GONGBAO`
2. 验证能够搜索到包含"宫保"的菜品（支持拼音搜索需要额外处理）

**预期结果**：
- 能够正确搜索到菜品（如果使用中文）

---

### 测试用例 7：搜索描述字段

**测试目标**：验证搜索能匹配描述字段  
**请求方式**：GET  
**请求URL**：`/api/dish?keyword=麻辣`  

**前置条件**：
- 数据库中存在描述包含"麻辣"的菜品

**测试步骤**：
1. 发送GET请求
2. 验证返回的菜品中，名称或描述包含"麻辣"

**预期结果**：
- 返回名称或描述匹配的菜品

---

## 前端测试用例

### 测试用例 8：Inventory页面 - 搜索框输入

**测试目标**：验证商家库存页面搜索功能  
**测试页面**：`/merchant/inventory`  

**测试步骤**：
1. 登录商家账号
2. 进入菜品库存页面
3. 在搜索框中输入"宫保"
4. 观察菜品列表更新

**预期结果**：
- 搜索框正常显示
- 输入后自动触发搜索
- 列表只显示包含"宫保"的菜品
- 分类侧边栏正常工作

---

### 测试用例 9：Inventory页面 - 清空搜索

**测试目标**：验证清空搜索功能  
**测试页面**：`/merchant/inventory`  

**测试步骤**：
1. 在搜索框中输入关键词
2. 点击搜索框的清除按钮
3. 观察菜品列表

**预期结果**：
- 搜索框内容被清空
- 菜品列表恢复显示所有菜品
- 分类结构保持正常

---

### 测试用例 10：MenuBrowse页面 - 搜索框输入

**测试目标**：验证顾客菜单浏览页面搜索功能  
**测试页面**：`/menu-browse`  

**测试步骤**：
1. 进入菜单浏览页面
2. 在搜索框中输入"辣"
3. 观察菜品列表更新

**预期结果**：
- 搜索框正常显示
- 列表只显示名称或描述包含"辣"的菜品
- 已下架的菜品不显示
- 分类侧边栏正常

---

### 测试用例 11：MenuBrowse页面 - 搜索无结果

**测试目标**：验证搜索无结果时的显示  
**测试页面**：`/menu-browse`  

**测试步骤**：
1. 在搜索框中输入不存在的菜品名称
2. 观察页面显示

**预期结果**：
- 显示"暂无菜品"提示
- 页面不报错
- 搜索框保持可用

---

### 测试用例 12：响应式搜索

**测试目标**：验证搜索的实时响应  
**测试页面**：`/merchant/inventory` 或 `/menu-browse`  

**测试步骤**：
1. 在搜索框中逐字输入"宫保鸡丁"
2. 观察每次输入后的列表变化

**预期结果**：
- 每次输入都会触发搜索
- 列表实时更新
- 性能流畅，无明显卡顿

---

## 性能测试用例

### 测试用例 13：大数据量搜索性能

**测试目标**：验证在大量菜品数据下的搜索性能  
**前置条件**：数据库中有1000+菜品

**测试步骤**：
1. 发送搜索请求
2. 记录响应时间

**预期结果**：
- 响应时间 < 500ms
- 搜索结果准确

---

### 测试用例 14：频繁搜索请求

**测试目标**：验证频繁搜索时的系统稳定性  

**测试步骤**：
1. 在1秒内连续发送10次搜索请求
2. 观察系统响应

**预期结果**：
- 所有请求都能正常响应
- 系统不崩溃
- 返回正确的搜索结果

---

## 兼容性测试用例

### 测试用例 15：特殊字符搜索

**测试目标**：验证特殊字符的处理  
**请求URL**：`/api/dish?keyword=鸡%20（大份）`  

**测试步骤**：
1. 搜索包含特殊字符的菜品名称
2. 验证搜索结果

**预期结果**：
- 能够正确处理特殊字符
- 返回匹配的菜品

---

### 测试用例 16：空格处理

**测试目标**：验证搜索关键词中的空格处理  
**请求URL**：`/api/dish?keyword=%20%20宫保%20%20`  

**测试步骤**：
1. 搜索前后带空格的关键词
2. 验证搜索结果

**预期结果**：
- 自动去除首尾空格
- 返回正确的搜索结果

---

## 测试总结

### 测试覆盖率目标
- 后端API：100%
- 前端页面：100%
- 边界情况：90%

### 关键测试指标
- 搜索准确率：100%
- 搜索响应时间：< 500ms
- 前端响应流畅度：无卡顿

### 已知限制
- 当前搜索仅支持中文关键词，不支持拼音搜索
- 搜索不支持模糊匹配（如容错输入）
