# 前端数据报表界面测试用例

## 测试模块
ChatUI - 商家后台 - 数据报表界面

## 测试日期
2026-01-29

---

## 前置条件

1. **后端服务运行**
   - ChatBackEnd服务已启动（http://localhost:3001）
   - MongoDB数据库中有completed状态的订单数据
   
2. **前端服务运行**
   - ChatUI服务已启动（http://localhost:3000）
   
3. **用户登录**
   - 已注册用户账号
   - 已成功登录系统

---

## 测试用例 1: 页面导航

### 测试目标
验证从商家后台首页能正常导航到数据报表页面

### 测试步骤
1. 打开浏览器访问 http://localhost:3000
2. 注册/登录账号
3. 选择"商家后台"角色
4. 在商家后台首页，点击"数据报表"卡片

### 预期结果
- 成功跳转到数据报表页面（URL: /merchant/reports）
- 页面标题显示"数据报表"
- 显示返回按钮

### 验证点
- [ ] 页面跳转成功
- [ ] 导航栏标题正确
- [ ] 返回按钮功能正常

---

## 测试用例 2: 数据加载状态

### 测试目标
验证页面加载时显示正确的加载状态

### 测试步骤
1. 进入数据报表页面
2. 观察页面加载过程

### 预期结果
- 初始显示加载动画（SpinLoading）
- 显示"加载中..."提示文字
- 加载完成后显示数据内容

### 验证点
- [ ] 加载动画显示正确
- [ ] 加载提示文字清晰
- [ ] 加载完成后动画消失

---

## 测试用例 3: 今日营收卡片展示

### 测试目标
验证今日营收数据正确展示

### 测试步骤
1. 等待页面加载完成
2. 查看"今日营收"卡片

### 预期结果
```
今日营收          2026-01-29
--------------------------------
¥1580.50
订单数量：15 单
```

### 验证点
- [ ] 卡片标题为"今日营收"
- [ ] 显示当前日期
- [ ] 收入金额格式正确（¥符号、2位小数）
- [ ] 收入金额字体大、醒目（蓝色）
- [ ] 显示订单数量统计
- [ ] 数据与后端API返回一致

---

## 测试用例 4: 菜品排行榜展示

### 测试目标
验证菜品销量排行榜正确展示

### 测试步骤
1. 等待页面加载完成
2. 查看"菜品销量排行榜 TOP 10"卡片

### 预期结果
- 显示最多10个菜品
- 每个菜品显示：
  - 排名序号（前3名有特殊颜色标识）
  - 菜品名称
  - 总收入金额
  - 销量柱状图
  - 销量数字（XX份）
  - 订单出现次数

### 验证点
- [ ] 卡片标题正确
- [ ] 前3名排名序号有特殊颜色（红、橙、黄）
- [ ] 菜品按销量降序排列
- [ ] 柱状图宽度与销量成正比
- [ ] 第一名的柱状图是100%宽度
- [ ] 显示每个菜品的总收入
- [ ] 显示"出现在X个订单中"统计

---

## 测试用例 5: 空数据展示

### 测试目标
验证没有数据时的展示效果

### 前置条件
- 数据库中没有completed状态的订单

### 测试步骤
1. 清空数据库中的completed订单
2. 刷新数据报表页面

### 预期结果
- 今日营收显示：¥0.00
- 订单数量显示：0 单
- 菜品排行榜显示"暂无数据"（Empty组件）

### 验证点
- [ ] 营收为0时正常显示
- [ ] 空状态提示友好
- [ ] 不显示错误信息

---

## 测试用例 6: 错误处理

### 测试目标
验证API请求失败时的错误处理

### 测试步骤
1. 关闭后端服务
2. 访问数据报表页面

### 预期结果
- 显示错误提示（ErrorBlock组件）
- 提示内容："加载失败"
- 显示具体错误信息

### 验证点
- [ ] 错误提示清晰
- [ ] 不会导致页面崩溃
- [ ] 显示Toast提示

---

## 测试用例 7: 数据格式验证

### 测试目标
验证各种数据格式的正确显示

### 测试数据
- 大金额：¥99,999.99
- 小金额：¥0.01
- 整数金额：¥100.00
- 大销量：9999份
- 小销量：1份

### 预期结果
- 所有金额都保留2位小数
- 金额格式统一（¥符号）
- 销量数字正确显示
- 没有显示异常或格式错误

### 验证点
- [ ] 金额格式统一
- [ ] 小数位正确
- [ ] 大数值不溢出
- [ ] 小数值不丢失精度

---

## 测试用例 8: UI样式验证

### 测试目标
验证页面样式和布局正确

### 验证点
- [ ] 导航栏样式正确
- [ ] 卡片间距合理（16px）
- [ ] 卡片内边距合理
- [ ] 字体大小层次分明
- [ ] 颜色使用合理（主色调蓝色）
- [ ] 前3名排名有颜色区分
- [ ] 柱状图颜色醒目（蓝色）
- [ ] 柱状图背景色浅灰
- [ ] 分隔线显示清晰

---

## 测试用例 9: 响应式布局

### 测试目标
验证不同屏幕尺寸下的显示效果

### 测试步骤
1. 使用Chrome DevTools调整屏幕尺寸
2. 测试以下尺寸：
   - iPhone 12 Pro (390x844)
   - iPhone SE (375x667)
   - iPad (768x1024)

### 预期结果
- 各种屏幕尺寸下布局正常
- 文字和图表不会溢出
- 触摸区域大小合适

### 验证点
- [ ] 小屏幕适配良好
- [ ] 大屏幕不会过于宽松
- [ ] 内容居中或合理分布

---

## 测试用例 10: 返回功能

### 测试目标
验证返回按钮功能正常

### 测试步骤
1. 在数据报表页面
2. 点击左上角返回按钮

### 预期结果
- 返回商家后台首页
- URL变为 /merchant
- 页面状态保持正常

### 验证点
- [ ] 返回功能正常
- [ ] 页面跳转流畅
- [ ] 没有报错

---

## 测试用例 11: 实时数据更新

### 测试目标
验证页面重新加载后数据更新

### 测试步骤
1. 查看当前数据报表
2. 在后端创建并完成一个新订单
3. 刷新数据报表页面

### 预期结果
- 今日营收增加
- 订单数量+1
- 菜品排行榜更新

### 验证点
- [ ] 数据实时性正确
- [ ] 刷新后数据更新
- [ ] 计算准确无误

---

## 测试用例 12: 性能测试

### 测试目标
验证大量数据时的性能表现

### 前置条件
- 数据库中有100+个菜品
- 数据库中有1000+个订单

### 测试步骤
1. 进入数据报表页面
2. 观察加载时间和渲染性能

### 预期结果
- 页面加载时间 < 2秒
- 页面渲染流畅，无卡顿
- 柱状图动画流畅

### 验证点
- [ ] 加载速度可接受
- [ ] 没有明显延迟
- [ ] 动画流畅

---

## 测试用例 13: 网络错误恢复

### 测试目标
验证网络恢复后能否正常获取数据

### 测试步骤
1. 断开网络连接
2. 进入数据报表页面（显示错误）
3. 恢复网络连接
4. 刷新页面

### 预期结果
- 网络恢复后数据正常加载
- 错误状态清除
- 显示正常数据

### 验证点
- [ ] 错误恢复正确
- [ ] 数据重新加载
- [ ] 状态管理正确

---

## 集成测试：完整流程

### 测试场景
从登录到查看数据报表的完整用户流程

### 测试步骤
1. 打开应用（http://localhost:3000）
2. 注册新用户（如果需要）
3. 登录系统
4. 选择"商家后台"
5. 点击"数据报表"
6. 查看今日营收和菜品排行
7. 点击返回
8. 再次进入数据报表（测试缓存）

### 验证点
- [ ] 整个流程无报错
- [ ] 页面跳转流畅
- [ ] 数据显示正确
- [ ] 用户体验良好

---

## 浏览器兼容性测试

### 测试浏览器
- [ ] Chrome (最新版)
- [ ] Safari (最新版)
- [ ] Firefox (最新版)
- [ ] Edge (最新版)
- [ ] 移动端浏览器（iOS Safari, Chrome Mobile）

### 验证点
- [ ] 所有浏览器显示正常
- [ ] API调用正常
- [ ] 样式一致

---

## API调用验证

### 验证点
- [ ] 正确调用 GET /api/ordering/reports/today-revenue
- [ ] 正确调用 GET /api/ordering/reports/dish-ranking?limit=10
- [ ] 请求头包含认证信息（如果需要）
- [ ] 响应数据格式正确
- [ ] 错误响应正确处理

### 检查方法
打开Chrome DevTools -> Network标签，查看：
- 请求URL是否正确
- 请求方法是否正确
- 响应状态码是否为200
- 响应数据格式是否符合预期

---

## 测试环境

### 开发环境
- **前端**: http://localhost:3000
- **后端**: http://localhost:3001
- **浏览器**: Chrome DevTools (Mobile模拟器)
- **测试工具**: React DevTools

### 测试数据要求
- 至少5个不同的菜品
- 至少10个completed订单
- 订单日期包含今日
- 订单中包含不同的菜品组合

---

## 测试结果汇总

| 测试用例 | 状态 | 备注 |
|---------|------|------|
| 测试用例 1 | 待测试 | 页面导航 |
| 测试用例 2 | 待测试 | 数据加载状态 |
| 测试用例 3 | 待测试 | 今日营收卡片展示 |
| 测试用例 4 | 待测试 | 菜品排行榜展示 |
| 测试用例 5 | 待测试 | 空数据展示 |
| 测试用例 6 | 待测试 | 错误处理 |
| 测试用例 7 | 待测试 | 数据格式验证 |
| 测试用例 8 | 待测试 | UI样式验证 |
| 测试用例 9 | 待测试 | 响应式布局 |
| 测试用例 10 | 待测试 | 返回功能 |
| 测试用例 11 | 待测试 | 实时数据更新 |
| 测试用例 12 | 待测试 | 性能测试 |
| 测试用例 13 | 待测试 | 网络错误恢复 |
| 集成测试 | 待测试 | 完整流程 |

---

## 截图示例

建议在测试过程中截取以下关键界面的截图：
1. 数据报表页面（有数据）
2. 数据报表页面（空数据）
3. 加载状态
4. 错误状态
5. 不同屏幕尺寸下的显示

---

## 已知问题

| 编号 | 发现日期 | 描述 | 严重程度 | 状态 | 解决方案 |
|------|---------|------|---------|------|---------|
| - | - | - | - | - | - |

---

## 测试结论

待测试完成后填写。

---

## 快速测试步骤

```bash
# 1. 启动后端服务
cd ChatBackEnd
npm run start:dev

# 2. 启动前端服务
cd ChatUI
npm start

# 3. 打开浏览器
# 访问 http://localhost:3000

# 4. 测试流程
# - 注册/登录
# - 选择商家后台
# - 点击数据报表
# - 验证数据展示
```

---

## 注意事项

1. **数据准备**：确保数据库中有测试数据
2. **网络环境**：确保前后端能正常通信
3. **浏览器控制台**：随时观察控制台错误
4. **Network面板**：检查API请求和响应
5. **移动端测试**：使用Chrome DevTools模拟移动设备
