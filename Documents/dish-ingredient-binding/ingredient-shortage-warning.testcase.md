# 菜品食材不足警告功能测试用例

## 功能描述
当菜品绑定的食材数量为0时，在菜品列表中：
1. 给菜品添加红色边框
2. 添加红色Tag标签，提示"食材不足"

---

## 前置条件

### 测试数据准备
1. **食材库存数据**：
   - 食材A（鸡肉）：quantity = 50，_id = "ingredient_001"
   - 食材B（猪肉）：quantity = 0，_id = "ingredient_002"（数量为0）
   - 食材C（牛肉）：quantity = 30，_id = "ingredient_003"
   - 食材D（羊肉）：quantity = 0，_id = "ingredient_004"（数量为0）

2. **菜品数据**：
   - 菜品1（白切鸡）：ingredients = ["ingredient_001"]（所有食材充足）
   - 菜品2（红烧猪肉）：ingredients = ["ingredient_002"]（有缺货食材）
   - 菜品3（麻辣牛肉）：ingredients = ["ingredient_003"]（所有食材充足）
   - 菜品4（杂烩煲）：ingredients = ["ingredient_001", "ingredient_002", "ingredient_003"]（部分食材缺货）
   - 菜品5（火锅拼盘）：ingredients = ["ingredient_002", "ingredient_004"]（所有绑定食材都缺货）
   - 菜品6（清炒时蔬）：ingredients = []（未绑定食材）

---

## 测试用例

### 用例 1：菜品未绑定食材
**测试步骤**：
1. 打开菜品库存页面
2. 查看"清炒时蔬"菜品项

**期望结果**：
- ✅ 菜品项无红色边框
- ✅ 不显示"食材不足"标签
- ✅ 正常显示其他标签（如果有）

**优先级**：P0（基础场景）

---

### 用例 2：菜品绑定的食材全部充足
**测试步骤**：
1. 打开菜品库存页面
2. 查看"白切鸡"菜品项（绑定鸡肉，quantity = 50）

**期望结果**：
- ✅ 菜品项无红色边框
- ✅ 不显示"食材不足"标签
- ✅ 正常显示菜品名称、价格、描述等信息

**优先级**：P0（基础场景）

---

### 用例 3：菜品绑定的单个食材数量为0
**测试步骤**：
1. 打开菜品库存页面
2. 查看"红烧猪肉"菜品项（绑定猪肉，quantity = 0）

**期望结果**：
- ✅ 菜品项显示红色边框（2px solid #ff4d4f）
- ✅ 边框圆角为8px
- ✅ 在描述下方显示红色"食材不足"标签
- ✅ 标签颜色为danger（红色）
- ✅ 菜品其他信息正常显示

**优先级**：P0（核心功能）

---

### 用例 4：菜品绑定多个食材，部分食材数量为0
**测试步骤**：
1. 打开菜品库存页面
2. 查看"杂烩煲"菜品项（绑定鸡肉quantity=50、猪肉quantity=0、牛肉quantity=30）

**期望结果**：
- ✅ 菜品项显示红色边框（2px solid #ff4d4f）
- ✅ 显示红色"食材不足"标签
- ✅ 只要有一个食材数量为0，就触发警告

**优先级**：P0（核心功能）

---

### 用例 5：菜品绑定的所有食材数量都为0
**测试步骤**：
1. 打开菜品库存页面
2. 查看"火锅拼盘"菜品项（绑定猪肉quantity=0、羊肉quantity=0）

**期望结果**：
- ✅ 菜品项显示红色边框
- ✅ 显示红色"食材不足"标签
- ✅ 警告提示明显且不重复（只显示一个"食材不足"标签）

**优先级**：P1（边界场景）

---

### 用例 6：警告标签与现有标签的共存
**测试步骤**：
1. 创建一个菜品，绑定缺货食材，并添加普通标签（如"招牌菜"、"微辣"）
2. 打开菜品库存页面
3. 查看该菜品项

**期望结果**：
- ✅ 红色边框正常显示
- ✅ "食材不足"标签显示在描述下方
- ✅ 现有标签（"招牌菜"、"微辣"）显示在"食材不足"标签下方
- ✅ 标签之间有合理间距
- ✅ 两种标签不混淆（颜色和位置区分明显）

**优先级**：P1（UI交互）

---

### 用例 7：食材数量从0变为非0
**测试步骤**：
1. 打开菜品库存页面，确认某菜品显示红色警告（食材quantity=0）
2. 进入库存管理页面，将该食材数量更新为10
3. 返回菜品库存页面，刷新或重新进入

**期望结果**：
- ✅ 菜品的红色边框消失
- ✅ "食材不足"标签消失
- ✅ 菜品恢复正常显示状态

**优先级**：P1（动态更新）

---

### 用例 8：食材数量从非0变为0
**测试步骤**：
1. 打开菜品库存页面，确认某菜品无红色警告（食材quantity>0）
2. 进入库存管理页面，将该食材数量更新为0
3. 返回菜品库存页面，刷新或重新进入

**期望结果**：
- ✅ 菜品显示红色边框
- ✅ 显示红色"食材不足"标签

**优先级**：P1（动态更新）

---

### 用例 9：多分类场景
**测试步骤**：
1. 打开菜品库存页面
2. 切换不同分类
3. 检查各分类下的菜品警告状态

**期望结果**：
- ✅ 所有分类下的菜品都能正确显示警告状态
- ✅ 分类切换不影响警告显示
- ✅ 警告样式一致

**优先级**：P2（全局一致性）

---

### 用例 10：边框样式不影响布局
**测试步骤**：
1. 打开菜品库存页面
2. 查看有红色边框的菜品和无边框的菜品

**期望结果**：
- ✅ 红色边框不导致菜品项位置偏移
- ✅ 菜品列表布局保持整齐
- ✅ marginBottom: '8px'确保菜品间距合理

**优先级**：P2（UI质量）

---

### 用例 11：性能测试 - 大量菜品场景
**测试步骤**：
1. 创建100个菜品，其中50个绑定缺货食材
2. 打开菜品库存页面

**期望结果**：
- ✅ 页面加载流畅，无明显延迟
- ✅ 所有警告正确显示
- ✅ 滚动流畅

**优先级**：P2（性能）

---

### 用例 12：编辑绑定缺货食材的菜品
**测试步骤**：
1. 打开菜品库存页面
2. 点击显示红色警告的菜品的"编辑"按钮
3. 查看编辑弹窗

**期望结果**：
- ✅ 编辑弹窗正常打开
- ✅ 已绑定的食材正确显示
- ✅ 可以正常修改菜品信息
- ✅ 可以移除或添加食材绑定

**优先级**：P1（功能完整性）

---

### 用例 13：下架显示红色警告的菜品
**测试步骤**：
1. 打开菜品库存页面
2. 找到显示红色警告的菜品
3. 点击"下架"按钮

**期望结果**：
- ✅ 菜品状态更新为"已下架"
- ✅ 红色边框和警告标签仍然显示
- ✅ 按钮文字变为"上架"

**优先级**：P2（状态交互）

---

## 数据验证

### 验证点1：inventoryList数据正确获取
**验证方法**：
```javascript
// 在浏览器控制台执行
console.log(inventoryList);
```

**期望结果**：
- 数组包含所有食材
- 每个食材包含_id和quantity字段

---

### 验证点2：hasOutOfStockIngredient函数逻辑正确
**验证方法**：
```javascript
// 测试函数逻辑
const testDish = {
  ingredients: ["ingredient_002"] // 数量为0的食材
};
console.log(hasOutOfStockIngredient(testDish)); // 应该返回true
```

---

## 回归测试

### 回归1：不绑定食材的菜品不受影响
- 验证原有未绑定食材的菜品显示正常
- 验证新建不绑定食材的菜品显示正常

### 回归2：原有标签功能不受影响
- 验证菜品标签（tags）仍然正常显示
- 验证标签样式和位置不变

### 回归3：菜品基本功能不受影响
- 验证编辑功能正常
- 验证上下架功能正常
- 验证分类过滤功能正常
- 验证滚动同步功能正常

---

## 浏览器兼容性测试

### 测试浏览器
- iOS Safari（主要目标）
- Android Chrome
- 桌面Chrome（开发调试）

### 测试要点
- 红色边框显示正常
- 标签文字清晰可读
- 布局不错乱
- 性能流畅

---

## 已知限制

1. **实时性**：食材数量更新后需要刷新页面才能看到警告状态变化
   - 建议：后续可以考虑WebSocket实时推送

2. **警告粒度**：只提示"食材不足"，不显示具体哪个食材缺货
   - 建议：点击警告标签可以查看详细缺货食材列表

3. **预警阈值**：目前只在数量为0时警告，无低库存预警
   - 建议：后续可以添加"即将用完"的黄色警告（如quantity < 10）

---

## 测试总结

**测试用例总数**：13个
- P0（核心功能）：4个
- P1（重要功能）：5个
- P2（质量保证）：4个

**覆盖范围**：
- ✅ 基础显示逻辑
- ✅ 边界场景
- ✅ 动态更新
- ✅ UI交互
- ✅ 性能测试
- ✅ 回归测试

**预计测试时间**：2-3小时
